{"version":3,"sources":["webpack:///./lib/random.js","webpack:///./lib/uiKit.js","webpack:///./routes/Chat/component.js","webpack:///./routes/Chat/container.js","webpack:///./routes/Chat/index.js"],"names":["chooseElement","arrayOrString","array","index","Math","floor","Uint32Array","window","crypto","getRandomValues","length","substr","createRandomId","charsCount","alphabet","Array","from","join","createRandomString","UIKitInteractionType","MODAL_OPEN","MODAL_CLOSE","MODAL_UPDATE","ERRORS","UIKitIncomingInteractionType","BLOCK","VIEW_SUBMIT","VIEW_CLOSED","UIKitIncomingInteractionContainerType","MESSAGE","VIEW","triggersId","Map","invalidateTriggerId","id","appId","get","delete","triggerAction","triggerId","params","result","type","actionId","rid","mid","viewId","container","payload","set","setTimeout","generateTriggerId","error","Promise","race","Livechat","post","_","reject","Error","interactionType","data","has","view","includes","MODAL_ClOSE","handlePayloadUserInteraction","Chat","state","atBottom","text","emojiPickerActive","handleFilesDropTargetRef","ref","filesDropTarget","handleMessagesContainerRef","messagesContainer","base","handleScrollTo","region","props","onTop","onBottom","MessageList","SCROLL_AT_BOTTOM","setState","SCROLL_AT_TOP","handleUploadClick","event","preventDefault","browse","handleSendClick","handleSubmit","onSubmit","turnOffEmojiPicker","handleChangeText","value","onChangeText","limitTextLength","substring","toggleEmojiPickerState","handleEmojiSelect","emoji","notifyEmojiSelect","native","handleEmojiClick","render","color","title","fontColor","uid","agent","typingUsernames","avatarResolver","conversationFinishedMessage","loading","onUpload","messages","uploads","options","onChangeDepartment","onFinishChat","onRemoveUserData","onPrintTranscript","lastReadMessageId","queueInfo","resetLastAction","Screen","I18n","t","nopadding","className","createClassName","styles","FilesDropTarget","overlayed","overlayText","Content","onScrollTo","style","position","zIndex","bottom","maxWidth","left","maxHeight","showPreview","showSkinTones","sheetSize","onSelect","autoFocus","Footer","Menu","Group","Item","onClick","icon","PrintIcon","ChangeIcon","RemoveIcon","danger","FinishIcon","limit","textLength","Composer","onChange","placeholder","click","pre","width","Component","ChatContainer","room","connectingAgent","queueSpot","triggerQueueMessage","estimatedWaitTime","checkConnectingAgent","newConnecting","newQueueSpot","newEstimatedWaitTime","connecting","spot","estimatedWaitTimeSeconds","handleQueueMessage","handleConnectingAgentAlert","normalizeQueueAlert","checkRoom","stateRoom","_id","loadMessages","grantUser","visitor","newUser","token","user","guest","dispatch","grantVisitor","getRoom","previousMessages","newRoom","alert","alerts","getGreetingMessages","reason","createToken","children","timeout","push","runCallbackEventEmitter","defaultRoomParams","noMoreMessages","initRoom","parentCall","handleTop","loadMoreMessages","startTyping","throttle","username","notifyVisitorTyping","stopTypingDebounced","stopTyping","debounce","map","message","actionsVisible","getAvatar","isVisitor","name","getAvatarUrl","defaultAvatar","client","host","url","defaultUrl","msg","avatar","trim","stop","all","sendMessage","doFileUpload","file","sizeAllowed","size","uploadFile","handleUpload","files","forEach","handleSoundStop","sound","play","route","closeChat","ModalManager","confirm","success","console","loadConfig","deleteVisitor","printContent","document","getElementById","innerHTML","head","getElementsByTagName","printWindow","open","printScript","createElement","write","body","appendChild","close","canSwitchDepartment","allowSwitchingDepartments","departments","filter","dept","showOnRegistration","canFinishChat","undefined","canRemoveUserData","allowRemoveUserData","canPrintTranscript","transcript","showOptionsMenu","onSoundStop","oldAlerts","this","connectingAgentAlertId","constants","item","warning","hideCloseButton","ts","livechatQueueMessageId","u","Date","toISOString","upsert","componentDidMount","componentDidUpdate","prevProps","nextLastMessage","lastMessage","visible","minimized","prevMessages","prevAlerts","unreadMessagesAlertId","unread","componentWillUnmount","ChatConnector","config","settings","fileUpload","guestDefaultAvatar","forceAcceptDataProcessingConsent","showConnecting","theme","iframe","customColor","customFontColor","customIconColor","iconColor","customTitle","typing","triggerAgent","status","email","emails","address","phone","phoneNumber","customFields","description","src","canRenderMessage","isArray"],"mappings":"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","file":"route-Chat.chunk.f081f.esm.js","sourcesContent":["const UNMISTAKABLE_CHARS = '23456789ABCDEFGHJKLMNPQRSTWXYZabcdefghijkmnopqrstuvwxyz';\n\nconst fraction = () => {\n\tconst array = new Uint32Array(1);\n\twindow.crypto.getRandomValues(array);\n\treturn array[0] * 2.3283064365386963e-10;\n};\n\nexport const chooseElement = (arrayOrString) => {\n\tconst index = Math.floor(fraction() * arrayOrString.length);\n\n\tif (typeof arrayOrString === 'string') {\n\t\treturn arrayOrString.substr(index, 1);\n\t}\n\n\treturn arrayOrString[index];\n};\n\nexport const createRandomString = (charsCount, alphabet) =>\n\tArray.from({ length: charsCount }, () => chooseElement(alphabet)).join('');\n\nexport const createRandomId = (charsCount = 17) =>\n\tcreateRandomString(charsCount, UNMISTAKABLE_CHARS);\n","import { Livechat } from '../api';\nimport { createRandomId } from './random';\n\nexport const UIKitInteractionType = {\n\tMODAL_OPEN: 'modal.open',\n\tMODAL_CLOSE: 'modal.close',\n\tMODAL_UPDATE: 'modal.update',\n\tERRORS: 'errors',\n};\n\nexport const UIKitIncomingInteractionType = {\n\tBLOCK: 'blockAction',\n\tVIEW_SUBMIT: 'viewSubmit',\n\tVIEW_CLOSED: 'viewClosed',\n};\n\nexport const UIKitIncomingInteractionContainerType = {\n\tMESSAGE: 'message',\n\tVIEW: 'view',\n};\n\nconst TRIGGER_TIMEOUT = 5000;\n\nconst triggersId = new Map();\n\n// const instances = new Map();\n\nconst invalidateTriggerId = (id) => {\n\tconst appId = triggersId.get(id);\n\ttriggersId.delete(id);\n\treturn appId;\n};\n\nconst generateTriggerId = (appId) => {\n\tconst triggerId = createRandomId();\n\ttriggersId.set(triggerId, appId);\n\tsetTimeout(invalidateTriggerId, TRIGGER_TIMEOUT, triggerId);\n\treturn triggerId;\n};\n\nconst handlePayloadUserInteraction = (type, { /* appId,*/ triggerId, ...data }) => {\n\tif (!triggersId.has(triggerId)) {\n\t\treturn;\n\t}\n\tconst appId = invalidateTriggerId(triggerId);\n\tif (!appId) {\n\t\treturn;\n\t}\n\n\tconst { view } = data;\n\tlet { viewId } = data;\n\n\tif (view && view.id) {\n\t\tviewId = view.id;\n\t}\n\n\tif (!viewId) {\n\t\treturn;\n\t}\n\n\tif ([UIKitInteractionType.ERRORS].includes(type)) {\n\t\t// events.emit(viewId, {\n\t\t// \ttype,\n\t\t// \ttriggerId,\n\t\t// \tviewId,\n\t\t// \tappId,\n\t\t// \t...data,\n\t\t// });\n\t\treturn UIKitInteractionType.ERRORS;\n\t}\n\n\tif ([UIKitInteractionType.MODAL_UPDATE].includes(type)) {\n\t\t// events.emit(viewId, {\n\t\t// \ttype,\n\t\t// \ttriggerId,\n\t\t// \tviewId,\n\t\t// \tappId,\n\t\t// \t...data,\n\t\t// });\n\t\treturn UIKitInteractionType.MODAL_UPDATE;\n\t}\n\n\tif ([UIKitInteractionType.MODAL_OPEN].includes(type)) {\n\t\t// const instance = modal.push({\n\t\t// \ttemplate: 'ModalBlock',\n\t\t// \tmodifier: 'uikit',\n\t\t// \tcloseOnEscape: false,\n\t\t// \tdata: {\n\t\t// \t\ttriggerId,\n\t\t// \t\tviewId,\n\t\t// \t\tappId,\n\t\t// \t\t...data,\n\t\t// \t},\n\t\t// });\n\t\t// instances.set(viewId, instance);\n\t\treturn UIKitInteractionType.MODAL_OPEN;\n\t}\n\n\treturn UIKitInteractionType.MODAL_ClOSE;\n};\n\nexport const triggerAction = async ({\n\tappId,\n\ttype,\n\tactionId,\n\trid,\n\tmid,\n\tviewId,\n\tcontainer,\n\tpayload,\n}) => {\n\tconst triggerId = generateTriggerId(appId);\n\n\ttry {\n\t\tconst params = {\n\t\t\ttype,\n\t\t\tactionId,\n\t\t\trid,\n\t\t\tmid,\n\t\t\tviewId,\n\t\t\tcontainer,\n\t\t\ttriggerId,\n\t\t\tpayload,\n\t\t};\n\n\t\tconst result = await Promise.race([\n\t\t\tLivechat.post(`apps/ui.interaction/${ appId }`, params),\n\t\t\tnew Promise((_, reject) => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\treject(new Error(triggerId));\n\t\t\t\t}, TRIGGER_TIMEOUT);\n\t\t\t}),\n\t\t]);\n\n\t\tconst { type: interactionType, ...data } = result;\n\n\t\treturn handlePayloadUserInteraction(interactionType, data);\n\t} catch (error) {\n\t\tinvalidateTriggerId(triggerId);\n\t\tthrow error;\n\t}\n};\n","import { Picker } from 'emoji-mart';\nimport { h, Component } from 'preact';\n\nimport { Composer, ComposerAction, ComposerActions } from '../../components/Composer';\nimport { FilesDropTarget } from '../../components/FilesDropTarget';\nimport { FooterOptions, CharCounter } from '../../components/Footer';\nimport { Menu } from '../../components/Menu';\nimport { MessageList } from '../../components/Messages';\nimport { Screen } from '../../components/Screen';\nimport { createClassName } from '../../components/helpers';\nimport I18n from '../../i18n';\nimport ChangeIcon from '../../icons/change.svg';\nimport FinishIcon from '../../icons/finish.svg';\nimport PlusIcon from '../../icons/plus.svg';\nimport PrintIcon from '../../icons/print.svg';\nimport RemoveIcon from '../../icons/remove.svg';\nimport SendIcon from '../../icons/send.svg';\nimport EmojiIcon from '../../icons/smile.svg';\nimport styles from './styles.scss';\n\nexport default class Chat extends Component {\n\tstate = {\n\t\tatBottom: true,\n\t\ttext: '',\n\t\temojiPickerActive: false,\n\t}\n\n\thandleFilesDropTargetRef = (ref) => {\n\t\tthis.filesDropTarget = ref;\n\t}\n\n\thandleMessagesContainerRef = (messagesContainer) => {\n\t\tthis.messagesContainer = messagesContainer ? messagesContainer.base : null;\n\t}\n\n\thandleScrollTo = (region) => {\n\t\tconst { onTop, onBottom } = this.props;\n\n\t\tif (region === MessageList.SCROLL_AT_BOTTOM) {\n\t\t\tthis.setState({ atBottom: true });\n\t\t\tonBottom && onBottom();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState({ atBottom: false });\n\n\t\tif (region === MessageList.SCROLL_AT_TOP) {\n\t\t\tonTop && onTop();\n\t\t}\n\t}\n\n\thandleUploadClick = (event) => {\n\t\tevent.preventDefault();\n\t\tthis.filesDropTarget.browse();\n\t}\n\n\thandleSendClick = (event) => {\n\t\tevent.preventDefault();\n\t\tthis.handleSubmit(this.state.text);\n\t}\n\n\thandleSubmit = (text) => {\n\t\tif (this.props.onSubmit) {\n\t\t\tthis.props.onSubmit(text);\n\t\t\tthis.setState({ text: '' });\n\t\t\tthis.turnOffEmojiPicker();\n\t\t}\n\t}\n\n\thandleChangeText = (text) => {\n\t\tlet value = text;\n\t\tconst { onChangeText, limitTextLength } = this.props;\n\t\tif (limitTextLength && limitTextLength < text.length) {\n\t\t\tvalue = value.substring(0, limitTextLength);\n\t\t}\n\t\tthis.setState({ text: value });\n\t\tonChangeText && onChangeText(value);\n\t}\n\n\ttoggleEmojiPickerState = () => {\n\t\tthis.setState({ emojiPickerActive: !this.state.emojiPickerActive });\n\t}\n\n\thandleEmojiSelect = (emoji) => {\n\t\tthis.toggleEmojiPickerState();\n\t\tthis.notifyEmojiSelect(emoji.native);\n\t}\n\n\thandleEmojiClick = () => {\n\t\tthis.turnOffEmojiPicker();\n\t}\n\n\tturnOffEmojiPicker = () => {\n\t\tif (this.state.emojiPickerActive) {\n\t\t\tthis.setState({ emojiPickerActive: !this.state.emojiPickerActive });\n\t\t}\n\t}\n\n\trender = ({\n\t\tcolor,\n\t\ttitle,\n\t\tfontColor,\n\t\tuid,\n\t\tagent,\n\t\ttypingUsernames,\n\t\tavatarResolver,\n\t\tconversationFinishedMessage,\n\t\tloading,\n\t\tonUpload,\n\t\tmessages,\n\t\tuploads = false,\n\t\toptions,\n\t\tonChangeDepartment,\n\t\tonFinishChat,\n\t\tonRemoveUserData,\n\t\tonPrintTranscript,\n\t\tlastReadMessageId,\n\t\tqueueInfo,\n\t\tlimitTextLength,\n\t\tresetLastAction,\n\t\t...props\n\t}, {\n\t\tatBottom = true,\n\t\ttext,\n\t}) => (\n\t\t<Screen\n\t\t\tcolor={color}\n\t\t\ttitle={title || I18n.t('Need help?')}\n\t\t\tfontColor={fontColor}\n\t\t\tagent={agent || null}\n\t\t\tqueueInfo={queueInfo}\n\t\t\tnopadding\n\t\t\toptions={options}\n\t\t\tonChangeDepartment={onChangeDepartment}\n\t\t\tonFinishChat={onFinishChat}\n\t\t\tonRemoveUserData={onRemoveUserData}\n\t\t\tclassName={createClassName(styles, 'chat')}\n\t\t\thandleEmojiClick={this.handleEmojiClick}\n\t\t\t{...props}\n\t\t>\n\t\t\t<FilesDropTarget\n\t\t\t\tref={this.handleFilesDropTargetRef}\n\t\t\t\toverlayed\n\t\t\t\toverlayText={I18n.t('Drop here to upload a file')}\n\t\t\t\tonUpload={onUpload}\n\t\t\t>\n\t\t\t\t<Screen.Content nopadding>\n\t\t\t\t\t<div id={'chat__messages'} className={createClassName(styles, 'chat__messages', { atBottom, loading })}>\n\t\t\t\t\t\t<MessageList\n\t\t\t\t\t\t\tref={this.handleMessagesContainerRef}\n\t\t\t\t\t\t\tavatarResolver={avatarResolver}\n\t\t\t\t\t\t\tuid={uid}\n\t\t\t\t\t\t\tmessages={messages}\n\t\t\t\t\t\t\ttypingUsernames={typingUsernames}\n\t\t\t\t\t\t\tconversationFinishedMessage={conversationFinishedMessage}\n\t\t\t\t\t\t\tlastReadMessageId={lastReadMessageId}\n\t\t\t\t\t\t\tonScrollTo={this.handleScrollTo}\n\t\t\t\t\t\t\tresetLastAction={resetLastAction}\n\t\t\t\t\t\t\thandleEmojiClick={this.handleEmojiClick}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{this.state.emojiPickerActive && <Picker\n\t\t\t\t\t\t\tstyle={{ position: 'absolute', zIndex: 10, bottom: 0, maxWidth: '90%', left: 20, maxHeight: '90%' }}\n\t\t\t\t\t\t\tshowPreview={false}\n\t\t\t\t\t\t\tshowSkinTones={false}\n\t\t\t\t\t\t\tsheetSize={64}\n\t\t\t\t\t\t\tonSelect={this.handleEmojiSelect}\n\t\t\t\t\t\t\tautoFocus={true}\n\t\t\t\t\t\t/>}\n\t\t\t\t\t</div>\n\t\t\t\t</Screen.Content>\n\t\t\t\t<Screen.Footer\n\t\t\t\t\toptions={options ? (\n\t\t\t\t\t\t<FooterOptions>\n\t\t\t\t\t\t\t<Menu.Group>\n\t\t\t\t\t\t\t\t{onPrintTranscript && (\n\t\t\t\t\t\t\t\t\t<Menu.Item onClick={onPrintTranscript} icon={PrintIcon}>{I18n.t('Print Chat')}</Menu.Item>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{onChangeDepartment && (\n\t\t\t\t\t\t\t\t\t<Menu.Item onClick={onChangeDepartment} icon={ChangeIcon}>{I18n.t('Change department')}</Menu.Item>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{onRemoveUserData && (\n\t\t\t\t\t\t\t\t\t<Menu.Item onClick={onRemoveUserData} icon={RemoveIcon}>{I18n.t('Forget/Remove my data')}</Menu.Item>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{onFinishChat && (\n\t\t\t\t\t\t\t\t\t<Menu.Item danger onClick={onFinishChat} icon={FinishIcon}>{I18n.t('Finish this chat')}</Menu.Item>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Menu.Group>\n\t\t\t\t\t\t</FooterOptions>\n\t\t\t\t\t) : null}\n\t\t\t\t\tlimit={limitTextLength\n\t\t\t\t\t\t? <CharCounter\n\t\t\t\t\t\t\tlimitTextLength={limitTextLength}\n\t\t\t\t\t\t\ttextLength={text.length}\n\t\t\t\t\t\t/> : null}\n\t\t\t\t>\n\t\t\t\t\t<Composer onUpload={onUpload}\n\t\t\t\t\t\tonSubmit={this.handleSubmit}\n\t\t\t\t\t\tonChange={this.handleChangeText}\n\t\t\t\t\t\tplaceholder={I18n.t('Type your message here')}\n\t\t\t\t\t\tvalue={text}\n\t\t\t\t\t\tnotifyEmojiSelect={(click) => { this.notifyEmojiSelect = click; }}\n\t\t\t\t\t\thandleEmojiClick={this.handleEmojiClick}\n\t\t\t\t\t\tpre={(\n\t\t\t\t\t\t\t<ComposerActions>\n\t\t\t\t\t\t\t\t<ComposerAction onClick={this.toggleEmojiPickerState}>\n\t\t\t\t\t\t\t\t\t<EmojiIcon width={20} />\n\t\t\t\t\t\t\t\t</ComposerAction>\n\t\t\t\t\t\t\t</ComposerActions>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tpost={(\n\t\t\t\t\t\t\t<ComposerActions>\n\t\t\t\t\t\t\t\t{text.length === 0 && uploads && (\n\t\t\t\t\t\t\t\t\t<ComposerAction onClick={this.handleUploadClick}>\n\t\t\t\t\t\t\t\t\t\t<PlusIcon width={20} />\n\t\t\t\t\t\t\t\t\t</ComposerAction>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{text.length > 0 && (\n\t\t\t\t\t\t\t\t\t<ComposerAction onClick={this.handleSendClick}>\n\t\t\t\t\t\t\t\t\t\t<SendIcon width={20} />\n\t\t\t\t\t\t\t\t\t</ComposerAction>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</ComposerActions>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tlimitTextLength={limitTextLength}\n\t\t\t\t\t/>\n\t\t\t\t</Screen.Footer>\n\t\t\t</FilesDropTarget>\n\t\t</Screen>\n\t)\n}\n","import { h, Component } from 'preact';\nimport { route } from 'preact-router';\n\nimport { Livechat } from '../../api';\nimport { ModalManager } from '../../components/Modal';\nimport { createToken, debounce, getAvatarUrl, canRenderMessage, throttle, upsert } from '../../components/helpers';\nimport I18n from '../../i18n';\nimport { normalizeQueueAlert } from '../../lib/api';\nimport constants from '../../lib/constants';\nimport { loadConfig } from '../../lib/main';\nimport { parentCall, runCallbackEventEmitter } from '../../lib/parentCall';\nimport { initRoom, closeChat, loadMessages, loadMoreMessages, defaultRoomParams, getGreetingMessages } from '../../lib/room';\nimport { Consumer } from '../../store';\nimport Chat from './component';\n\nexport class ChatContainer extends Component {\n\tstate = {\n\t\troom: null,\n\t\tconnectingAgent: false,\n\t\tqueueSpot: 0,\n\t\ttriggerQueueMessage: true,\n\t\testimatedWaitTime: null,\n\t}\n\n\tcheckConnectingAgent = async () => {\n\t\tconst { connecting, queueInfo } = this.props;\n\t\tconst { connectingAgent, queueSpot, estimatedWaitTime } = this.state;\n\n\t\tconst newConnecting = connecting;\n\t\tconst newQueueSpot = (queueInfo && queueInfo.spot) || 0;\n\t\tconst newEstimatedWaitTime = queueInfo && queueInfo.estimatedWaitTimeSeconds;\n\n\t\tif (newConnecting !== connectingAgent || newQueueSpot !== queueSpot || newEstimatedWaitTime !== estimatedWaitTime) {\n\t\t\tthis.state.connectingAgent = newConnecting;\n\t\t\tthis.state.queueSpot = newQueueSpot;\n\t\t\tthis.state.estimatedWaitTime = newEstimatedWaitTime;\n\t\t\tawait this.handleQueueMessage(connecting, queueInfo);\n\t\t\tawait this.handleConnectingAgentAlert(newConnecting, normalizeQueueAlert(queueInfo));\n\t\t}\n\t}\n\n\tcheckRoom = () => {\n\t\tconst { room } = this.props;\n\t\tconst { room: stateRoom } = this.state;\n\t\tif (room && (!stateRoom || room._id !== stateRoom._id)) {\n\t\t\tthis.state.room = room;\n\t\t\tsetTimeout(loadMessages, 500);\n\t\t}\n\t}\n\n\tgrantUser = async () => {\n\t\tconst { token, user, guest, dispatch } = this.props;\n\n\t\tif (user) {\n\t\t\treturn user;\n\t\t}\n\n\t\tconst visitor = { token, ...guest };\n\t\tconst newUser = await Livechat.grantVisitor({ visitor });\n\t\tawait dispatch({ user: newUser });\n\t}\n\n\tgetRoom = async () => {\n\t\tconst { alerts, dispatch, room, messages } = this.props;\n\t\tconst previousMessages = getGreetingMessages(messages);\n\n\t\tif (room) {\n\t\t\treturn room;\n\t\t}\n\n\t\tawait dispatch({ loading: true });\n\t\ttry {\n\t\t\tconst params = defaultRoomParams();\n\t\t\tconst newRoom = await Livechat.room(params);\n\t\t\tawait dispatch({ room: newRoom, messages: previousMessages, noMoreMessages: false });\n\t\t\tawait initRoom();\n\n\t\t\tparentCall('callback', 'chat-started');\n\t\t\treturn newRoom;\n\t\t} catch (error) {\n\t\t\tconst { data: { error: reason } } = error;\n\t\t\tconst alert = { id: createToken(), children: I18n.t('Error starting a new conversation: %{reason}', { reason }), error: true, timeout: 10000 };\n\t\t\tawait dispatch({ loading: false, alerts: (alerts.push(alert), alerts) });\n\n\t\t\trunCallbackEventEmitter(reason);\n\t\t\tthrow error;\n\t\t} finally {\n\t\t\tawait dispatch({ loading: false });\n\t\t}\n\t}\n\n\thandleTop = () => {\n\t\tloadMoreMessages();\n\t}\n\n\tstartTyping = throttle(async ({ rid, username }) => {\n\t\tawait Livechat.notifyVisitorTyping(rid, username, true);\n\t\tthis.stopTypingDebounced({ rid, username });\n\t}, 4500)\n\n\tstopTyping = ({ rid, username }) => Livechat.notifyVisitorTyping(rid, username, false)\n\n\tstopTypingDebounced = debounce(this.stopTyping, 5000)\n\n\thandleChangeText = async () => {\n\t\tconst { user, room } = this.props;\n\t\tif (!(user && user.username && room && room._id)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.startTyping({ rid: room._id, username: user.username });\n\t}\n\n\tresetLastAction = () => {\n\t\t// makes all actions button invisible\n\t\tconst { messages, dispatch } = this.props;\n\n\t\tconst newMessages = messages.map((message) => {\n\t\t\tif (message.actionsVisible) {\n\t\t\t\tmessage.actionsVisible = false;\n\t\t\t}\n\t\t\treturn message;\n\t\t});\n\t\tdispatch({ messages: newMessages });\n\t}\n\n\tgetAvatar = (username, isVisitor = false, name = null) => {\n\t\tif (!isVisitor || name) {\n\t\t\treturn getAvatarUrl(name || username);\n\t\t}\n\n\t\tconst { defaultAvatar } = this.props;\n\t\treturn `${ Livechat.client.host }/${ defaultAvatar.url || defaultAvatar.defaultUrl }`;\n\t}\n\n\thandleSubmit = async (msg) => {\n\t\tif (msg.trim() === '') {\n\t\t\treturn;\n\t\t}\n\n\t\tawait this.grantUser();\n\t\tconst { _id: rid } = await this.getRoom();\n\t\tconst { alerts, dispatch, token, user } = this.props;\n\t\tconst avatar = this.getAvatar(user.username, true, user.name);\n\n\t\ttry {\n\t\t\tthis.stopTypingDebounced.stop();\n\t\t\tthis.resetLastAction();\n\t\t\tawait Promise.all([\n\t\t\t\tthis.stopTyping({ rid, username: user.username }),\n\t\t\t\tLivechat.sendMessage({ msg, token, rid, avatar }),\n\t\t\t]);\n\t\t} catch (error) {\n\t\t\tconst { data: { error: reason } } = error;\n\t\t\tconst alert = { id: createToken(), children: reason, error: true, timeout: 5000 };\n\t\t\tawait dispatch({ alerts: (alerts.push(alert), alerts) });\n\t\t}\n\t\tawait Livechat.notifyVisitorTyping(rid, user.username, false);\n\t}\n\n\tdoFileUpload = async (rid, file) => {\n\t\tconst { alerts, dispatch } = this.props;\n\n\t\ttry {\n\t\t\tawait Livechat.uploadFile({ rid, file });\n\t\t} catch (error) {\n\t\t\tconst { data: { reason, sizeAllowed } } = error;\n\n\t\t\tlet message = I18n.t('FileUpload Error');\n\t\t\tswitch (reason) {\n\t\t\t\tcase 'error-type-not-allowed':\n\t\t\t\t\tmessage = I18n.t('Media Types Not Accepted.');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'error-size-not-allowed':\n\t\t\t\t\tmessage = I18n.t('File exceeds allowed size of %{size}.', { size: sizeAllowed });\n\t\t\t}\n\n\t\t\tconst alert = { id: createToken(), children: message, error: true, timeout: 5000 };\n\t\t\tawait dispatch({ alerts: (alerts.push(alert), alerts) });\n\t\t}\n\t};\n\n\thandleUpload = async (files) => {\n\t\tawait this.grantUser();\n\t\tconst { _id: rid } = await this.getRoom();\n\n\t\tfiles.forEach((file) => this.doFileUpload(rid, file));\n\t}\n\n\thandleSoundStop = async () => {\n\t\tconst { dispatch, sound = {} } = this.props;\n\t\tawait dispatch({ sound: { ...sound, play: false } });\n\t}\n\n\tonChangeDepartment = () => {\n\t\troute('/switch-department');\n\t}\n\n\tonFinishChat = async () => {\n\t\tconst { success } = await ModalManager.confirm({\n\t\t\ttext: I18n.t('Are you sure you want to finish this chat?'),\n\t\t});\n\n\t\tif (!success) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { alerts, dispatch, room: { _id: rid } = {} } = this.props;\n\n\t\tawait dispatch({ loading: true });\n\t\ttry {\n\t\t\tif (rid) {\n\t\t\t\tawait Livechat.closeChat({ rid });\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t\tconst alert = { id: createToken(), children: I18n.t('Error closing chat.'), error: true, timeout: 0 };\n\t\t\tawait dispatch({ alerts: (alerts.push(alert), alerts) });\n\t\t} finally {\n\t\t\tawait dispatch({ loading: false });\n\t\t\tawait closeChat();\n\t\t}\n\t}\n\n\tonRemoveUserData = async () => {\n\t\tconst { success } = await ModalManager.confirm({\n\t\t\ttext: I18n.t('Are you sure you want to remove all of your personal data?'),\n\t\t});\n\n\t\tif (!success) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { alerts, dispatch } = this.props;\n\n\t\tawait dispatch({ loading: true });\n\t\ttry {\n\t\t\tawait Livechat.deleteVisitor();\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t\tconst alert = { id: createToken(), children: I18n.t('Error removing user data.'), error: true, timeout: 0 };\n\t\t\tawait dispatch({ alerts: (alerts.push(alert), alerts) });\n\t\t} finally {\n\t\t\tawait loadConfig();\n\t\t\tawait dispatch({ loading: false });\n\t\t\troute('/chat-finished');\n\t\t}\n\t}\n\n\tonPrintTranscript = () => {\n\t\tconst printContent = document.getElementById('chat__messages').innerHTML;\n\t\tlet head = document.getElementsByTagName('head')[0].innerHTML\n\t\tlet printWindow = window.open();\n\t\tlet printScript = printWindow.document.createElement( 'script' );\n\t\tprintScript.innerHTML = \"window.print();\";\n\t\tprintWindow.document.write(printContent);\n\t\tprintWindow.document.body.appendChild(printScript);\n\t\tprintWindow.document.head.innerHTML = head;\n\t\tprintWindow.document.close();\n\t}\n\n\tcanSwitchDepartment = () => {\n\t\tconst { allowSwitchingDepartments, departments = {} } = this.props;\n\t\treturn allowSwitchingDepartments && departments.filter((dept) => dept.showOnRegistration).length > 1;\n\t}\n\n\tcanFinishChat = () => {\n\t\tconst { room, connecting } = this.props;\n\t\treturn (room !== undefined) || connecting;\n\t}\n\n\tcanRemoveUserData = () => {\n\t\tconst { allowRemoveUserData } = this.props;\n\t\treturn allowRemoveUserData;\n\t}\n\n\tcanPrintTranscript = () => {\n\t\tconst { transcript } = this.props;\n\t\treturn transcript;\n\t}\n\n\tshowOptionsMenu = () =>\n\t\tthis.canSwitchDepartment() || this.canFinishChat() || this.canRemoveUserData()\n\n\n\tasync handleConnectingAgentAlert(connecting, message) {\n\t\tconst { alerts: oldAlerts, dispatch } = this.props;\n\t\tconst { connectingAgentAlertId } = constants;\n\t\tconst alerts = oldAlerts.filter((item) => item.id !== connectingAgentAlertId);\n\t\tif (connecting) {\n\t\t\talerts.push({\n\t\t\t\tid: connectingAgentAlertId,\n\t\t\t\tchildren: message || I18n.t('Please, wait for the next available agent..'),\n\t\t\t\twarning: true,\n\t\t\t\thideCloseButton: true,\n\t\t\t\ttimeout: 0,\n\t\t\t});\n\t\t}\n\n\t\tawait dispatch({ alerts });\n\t}\n\n\tasync handleQueueMessage(connecting, queueInfo) {\n\t\tif (!queueInfo) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { livechatQueueMessageId } = constants;\n\t\tconst { message: { text: msg, user: u } = {} } = queueInfo;\n\t\tconst { triggerQueueMessage } = this.state;\n\n\t\tconst { room } = this.props;\n\t\tif (!room || !connecting || !msg || !triggerQueueMessage) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.state.triggerQueueMessage = false;\n\n\t\tconst { dispatch, messages } = this.props;\n\t\tconst ts = new Date();\n\t\tconst message = { _id: livechatQueueMessageId, msg, u, ts: ts.toISOString() };\n\t\tawait dispatch({\n\t\t\tmessages: upsert(messages, message, ({ _id }) => _id === message._id, ({ ts }) => ts),\n\t\t});\n\t}\n\n\tasync componentDidMount() {\n\t\tawait this.checkConnectingAgent();\n\t\tloadMessages();\n\t}\n\n\tasync componentDidUpdate(prevProps) {\n\t\tconst { messages, visible, minimized, dispatch } = this.props;\n\t\tconst { messages: prevMessages, alerts: prevAlerts } = prevProps;\n\n\t\tif (messages && prevMessages && messages.length !== prevMessages.length && visible && !minimized) {\n\t\t\tconst nextLastMessage = messages[messages.length - 1];\n\t\t\tconst lastMessage = prevMessages[prevMessages.length - 1];\n\t\t\tif ((nextLastMessage && lastMessage && nextLastMessage._id !== lastMessage._id) || (messages.length === 1 && prevMessages.length === 0)) {\n\t\t\t\tconst newAlerts = prevAlerts.filter((item) => item.id !== constants.unreadMessagesAlertId);\n\t\t\t\tdispatch({ alerts: newAlerts, unread: null, lastReadMessageId: nextLastMessage._id });\n\t\t\t}\n\t\t}\n\n\t\tawait this.checkConnectingAgent();\n\t\tthis.checkRoom();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.handleConnectingAgentAlert(false);\n\t}\n\n\trender = ({ user, ...props }) => (\n\t\t<Chat\n\t\t\t{...props}\n\t\t\tavatarResolver={this.getAvatar}\n\t\t\tuid={user && user._id}\n\t\t\tonTop={this.handleTop}\n\t\t\tonChangeText={this.handleChangeText}\n\t\t\tonSubmit={this.handleSubmit}\n\t\t\tonUpload={this.handleUpload}\n\t\t\toptions={this.showOptionsMenu()}\n\t\t\tonChangeDepartment={(this.canSwitchDepartment() && this.onChangeDepartment) || null}\n\t\t\tonFinishChat={(this.canFinishChat() && this.onFinishChat) || null}\n\t\t\tonRemoveUserData={(this.canRemoveUserData() && this.onRemoveUserData) || null}\n\t\t\tonPrintTranscript={(this.canPrintTranscript() && this.onPrintTranscript) || null}\n\t\t\tonSoundStop={this.handleSoundStop}\n\t\t\tresetLastAction={this.resetLastAction}\n\t\t/>\n\t)\n}\n\n\nexport const ChatConnector = ({ ref, ...props }) => (\n\t<Consumer>\n\t\t{({\n\t\t\tconfig: {\n\t\t\t\tsettings: {\n\t\t\t\t\tfileUpload: uploads,\n\t\t\t\t\tguestDefaultAvatar: defaultAvatar,\n\t\t\t\t\tallowSwitchingDepartments,\n\t\t\t\t\tforceAcceptDataProcessingConsent: allowRemoveUserData,\n\t\t\t\t\tshowConnecting,\n\t\t\t\t\ttranscript,\n                    limitTextLength,\n\t\t\t\t} = {},\n\t\t\t\tmessages: {\n\t\t\t\t\tconversationFinishedMessage,\n\t\t\t\t} = {},\n\t\t\t\ttheme: {\n\t\t\t\t\tcolor,\n\t\t\t\t\ttitle,\n\t\t\t\t} = {},\n\t\t\t\tdepartments = {},\n\t\t\t},\n\t\t\tiframe: {\n\t\t\t\ttheme: {\n\t\t\t\t\tcolor: customColor,\n\t\t\t\t\tfontColor: customFontColor,\n\t\t\t\t\ticonColor: customIconColor,\n\t\t\t\t\ttitle: customTitle,\n\t\t\t\t} = {},\n\t\t\t\tguest,\n\t\t\t} = {},\n\t\t\ttoken,\n\t\t\tagent,\n\t\t\tsound,\n\t\t\tuser,\n\t\t\troom,\n\t\t\tmessages,\n\t\t\tnoMoreMessages,\n\t\t\ttyping,\n\t\t\tloading,\n\t\t\tdispatch,\n\t\t\talerts,\n\t\t\tvisible,\n\t\t\tunread,\n\t\t\tlastReadMessageId,\n\t\t\ttriggerAgent,\n\t\t\tqueueInfo,\n\t\t}) => (\n\t\t\t<ChatContainer\n\t\t\t\tref={ref}\n\t\t\t\t{...props}\n\t\t\t\ttheme={{\n\t\t\t\t\tcolor: customColor || color,\n\t\t\t\t\tfontColor: customFontColor,\n\t\t\t\t\ticonColor: customIconColor,\n\t\t\t\t\ttitle: customTitle,\n\t\t\t\t}}\n\t\t\t\ttitle={customTitle || title || I18n.t('Need help?')}\n\t\t\t\tsound={sound}\n\t\t\t\ttoken={token}\n\t\t\t\tuser={user}\n\t\t\t\tagent={agent ? {\n\t\t\t\t\t_id: agent._id,\n\t\t\t\t\tname: agent.name,\n\t\t\t\t\tstatus: agent.status,\n\t\t\t\t\temail: agent.emails && agent.emails[0] && agent.emails[0].address,\n\t\t\t\t\tusername: agent.username,\n\t\t\t\t\tphone: (agent.phone && agent.phone[0] && agent.phone[0].phoneNumber) || (agent.customFields && agent.customFields.phone),\n\t\t\t\t\tavatar: agent.username ? {\n\t\t\t\t\t\tdescription: agent.username,\n\t\t\t\t\t\tsrc: getAvatarUrl(agent.username),\n\t\t\t\t\t} : undefined,\n\t\t\t\t} : undefined}\n\t\t\t\troom={room}\n\t\t\t\tmessages={messages && messages.filter((message) => canRenderMessage(message))}\n\t\t\t\tnoMoreMessages={noMoreMessages}\n\t\t\t\temoji={true}\n\t\t\t\tuploads={uploads}\n\t\t\t\ttypingUsernames={Array.isArray(typing) ? typing : []}\n\t\t\t\tloading={loading}\n\t\t\t\tshowConnecting={showConnecting} // setting from server that tells if app needs to show \"connecting\" sometimes\n\t\t\t\tconnecting={!!(room && !agent && (showConnecting || queueInfo))}\n\t\t\t\tdispatch={dispatch}\n\t\t\t\tdepartments={departments}\n\t\t\t\tdefaultAvatar={defaultAvatar}\n\t\t\t\tallowSwitchingDepartments={allowSwitchingDepartments}\n\t\t\t\tconversationFinishedMessage={conversationFinishedMessage || I18n.t('Conversation finished')}\n\t\t\t\tallowRemoveUserData={allowRemoveUserData}\n\t\t\t\ttranscript={transcript}\n\t\t\t\talerts={alerts}\n\t\t\t\tvisible={visible}\n\t\t\t\tunread={unread}\n\t\t\t\tlastReadMessageId={lastReadMessageId}\n\t\t\t\tguest={guest}\n\t\t\t\ttriggerAgent={triggerAgent}\n\t\t\t\tqueueInfo={queueInfo ? {\n\t\t\t\t\tspot: queueInfo.spot,\n\t\t\t\t\testimatedWaitTimeSeconds: queueInfo.estimatedWaitTimeSeconds,\n\t\t\t\t\tmessage: queueInfo.message,\n\t\t\t\t} : undefined}\n\t\t\t\tlimitTextLength={limitTextLength}\n\t\t\t/>\n\t\t)}\n\t</Consumer>\n);\n\n\nexport default ChatConnector;\n","export { default as Chat } from './component';\nexport { ChatContainer, ChatConnector } from './container';\nexport { default } from './container';\n"],"sourceRoot":""}