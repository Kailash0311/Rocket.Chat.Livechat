(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{ag5X:function(e,t,r){"use strict";r.r(t);var n=r("hosL"),a=r("co3k"),o=r("z4Qk"),l=r("qoM+"),i=r("jdJj"),u=r("PyG4"),s=r("fsQa"),c=r("8SHJ"),d=r.n(c);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function h(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=s.a.t("Leave a message"),O=s.a.t("We are not online right now. Please, leave a message."),y="",j=function(e){var t,r;function c(t){var r;return(r=e.call(this,t)||this).validations={name:[l.e.nonEmpty],email:[l.e.nonEmpty,l.e.email],department:[],message:[l.e.nonEmpty]},r.getDefaultState=function(){var e=r.props,t=e.hasDepartmentField,n=e.departments,a=null;return t&&n&&n.length>0&&(a={value:""}),{name:{value:""},email:{value:""},department:a,message:{value:""}}},r.getValidableFields=function(){return Object.keys(r.validations).map((function(e){return r.state[e]?b({fieldName:e},r.state[e]):null})).filter(Boolean)},r.validate=function(e){var t=e.name,n=e.value;return r.validations[t].reduce((function(e,t){return e||t({value:n})}),void 0)},r.validateAll=function(){for(var e,t=h(r.getValidableFields());!(e=t()).done;){var n,a=e.value,o=a.fieldName,l=a.value,i=r.validate({name:o,value:l});r.setState(((n={})[o]=b(b({},r.state[o]),{},{value:l,error:i,showError:!1}),n))}},r.reset=function(){return r.setState(r.getDefaultState())},r.isValid=function(){return r.getValidableFields().every((function(e){return!(void 0===e?{}:e).error}))},r.handleFieldChange=function(e){return function(t){var n,a=t.target.value,o=r.validate({name:e,value:a});r.setState(((n={})[e]=b(b({},r.state[e]),{},{value:a,error:o,showError:!1}),n)),r.validateAll()}},r.handleNameChange=r.handleFieldChange("name"),r.handleEmailChange=r.handleFieldChange("email"),r.handleDepartmentChange=r.handleFieldChange("department"),r.handleMessageChange=r.handleFieldChange("message"),r.handleSubmit=function(e){return new Promise((function(t,n){var a;if(e.preventDefault(),r.props.onSubmit)return a=Object.entries(r.state).filter((function(e){return null!==e[1]})).map((function(e){var t,r=e[0],n=e[1].value;return(t={})[r]=n,t})).reduce((function(e,t){return b(b({},e),t)}),{}),Promise.resolve(r.props.onSubmit(a)).then(function(e){try{return e&&r.reset(),o.call(this)}catch(e){return n(e)}}.bind(this),n);function o(){return t()}return o.call(this)}))},r.renderForm=function(e,t){var i=e.loading,c=e.departments,d=e.valid,f=void 0===d?r.isValid():d,h=t.name,m=t.email,p=t.department,b=t.message;return Object(n.h)(l.a,{onSubmit:r.handleSubmit},h?Object(n.h)(l.b,{required:!0,label:s.a.t("Name"),error:h.showError&&h.error},Object(n.h)(l.d,{name:"name",value:h.value,placeholder:s.a.t("Insert your %{field} here...",{field:s.a.t("Name")}),disabled:i,onInput:r.handleNameChange})):null,m?Object(n.h)(l.b,{required:!0,label:s.a.t("Email"),error:m.showError&&m.error},Object(n.h)(l.d,{name:"email",value:m.value,placeholder:s.a.t("Insert your %{field} here...",{field:s.a.t("Email")}),disabled:i,onInput:r.handleEmailChange})):null,p?Object(n.h)(l.b,{label:s.a.t("I need help with..."),error:p.showError&&p.error},Object(n.h)(l.c,{name:"department",value:p.value,options:Object(u.n)(c,"name").map((function(e){return{value:e._id,label:e.name}})),placeholder:s.a.t("Choose an option..."),disabled:i,error:p.showError,onInput:r.handleDepartmentChange})):null,b?Object(n.h)(l.b,{required:!0,label:s.a.t("Message"),error:b.showError&&b.error},Object(n.h)(l.d,{name:"message",value:b.value,multiline:!0,rows:4,placeholder:s.a.t("Write your message..."),disabled:i,error:b.showError,onInput:r.handleMessageChange})):null,Object(n.h)(o.a,null,Object(n.h)(a.a,{submit:!0,loading:i,disabled:!f||i,stack:!0},s.a.t("Send"))))},r.render=function(e){var t=e.color,a=e.title,o=e.message,l=e.unavailableMessage,s=e.hasForm,c=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["color","title","message","unavailableMessage","hasForm"]);return Object(n.h)(i.b,f({color:t,title:a||g,className:Object(u.d)(d.a,"leave-message")},c),Object(n.h)(i.b.Content,null,Object(n.h)("p",{className:Object(u.d)(d.a,"leave-message__main-message")},s?o||O:l||y),s&&r.renderForm(r.props,r.state)),Object(n.h)(i.b.Footer,null))},r.state=r.getDefaultState(),r}return r=e,(t=c).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,c.prototype.componentDidMount=function(){this.validateAll()},c}(n.Component),w=r("qPgm"),S=r("81xT"),P=r("vBLd"),C=r("kQFM");function F(){return(F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var E=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this).handleSubmit=function(e){return new Promise((function(r,n){var a,o,l,i,s,c,d,f=function(e){return function(t){try{return Promise.resolve(l({loading:!1})).then(function(r){try{return e&&e.call(this,t)}catch(e){return n(e)}}.bind(this),n)}catch(e){return n(e)}}.bind(this)}.bind(this);return a=t.props,o=a.alerts,l=a.dispatch,Promise.resolve(l({loading:!0})).then((function(t){try{var a=function(e){try{return c=e.data.message,console.error(c),d={id:Object(u.e)(),children:c,error:!0,timeout:5e3},Promise.resolve(l({alerts:(o.push(d),o)})).then((function(e){try{return f(r)(!1)}catch(e){return n(e)}}),n)}catch(e){return f(n)(e)}};try{return i=Object(u.l)(e),Promise.resolve(w.a.sendOfflineMessage(i)).then((function(t){try{return s=t,Promise.resolve(S.a.alert({text:s})).then((function(t){try{return Object(P.a)("callback",["offline-form-submit",e]),f(r)(!0)}catch(e){return a(e)}}),a)}catch(e){return a(e)}}),a)}catch(e){a(e)}}catch(e){return n(e)}}),n)}))},t.render=function(e){return Object(n.h)(j,F({},e,{onSubmit:t.handleSubmit}))},t}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(n.Component),M=function(e){var t=e.ref,r=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["ref"]);return Object(n.h)(C.a,null,(function(e){var a=e.config,o=(a=void 0===a?{}:a).departments,l=void 0===o?{}:o,i=a.messages,u=(i=void 0===i?{}:i).offlineMessage,s=i.offlineSuccessMessage,c=i.offlineUnavailableMessage,d=a.theme,f=(d=void 0===d?{}:d).offlineTitle,h=d.offlineColor,m=a.settings,p=(m=void 0===m?{}:m).displayOfflineForm,b=e.iframe,v=(b=void 0===b?{}:b).theme,g=(v=void 0===v?{}:v).offlineTitle,O=e.loading,y=e.token,j=e.dispatch,w=e.alerts;return Object(n.h)(E,F({ref:t},r,{theme:{color:h,offlineTitle:g},title:g||f,message:u,successMessage:s,unavailableMessage:c,loading:O,token:y,dispatch:j,alerts:w,hasForm:p,hasDepartmentField:l&&l.some((function(e){return e.showOnOfflineForm})),departments:l.filter((function(e){return e.showOnOfflineForm}))}))}))},k=M;r.d(t,"LeaveMessage",(function(){return j})),r.d(t,"LeaveMessageContainer",(function(){return E})),r.d(t,"LeaveMessageConnector",(function(){return M})),r.d(t,"default",(function(){return k}))}}]);
//# sourceMappingURL=route-LeaveMessage.chunk.c1ce0.esm.js.map